#!/usr/bin/make -f
DH_VERBOSE=1 
#include /usr/share/dpkg/architecture.mk

%:
	dh $@


override_dh_auto_configure:
	dh_auto_configure -- --prefix=/usr/local

#to install binary into usr/local/bin
override_dh_usrlocal:

#to bypass dwz: debian/digitalbits-core/usr/bin/digitalbits-core: Too many DIEs, not optimizing
# on ubuntu 20:04
override_dh_dwz:
	dh_dwz --exclude=/usr/bin/digitalbits-core --exclude=/usr/local/bin/digitalbits-core

#debian package requires ROOT uid or fakeroot(1) to set fs perms in binary outcome.
# postgresql cli tooling called by unit tests refuses run by ROOT(and has no way to check we use fakeroot(1))
# uid 1000 has to exists - to be added before deb-buildpackage called
dh_auto_test
	setpriv --reuid=1000 --regid=1000 --init-groups make check VERBOSE=1
